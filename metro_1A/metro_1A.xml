<fds>

    <!-- file naming -->
    <var chid="'metro_1A'" outfile="'metro_1A.fds'" />
    <info chid="chid" outfile="outfile"/>

    <!-- fixed input parameter -->
    <input text="TIME T_END=0.0" />
    <input text="MISC RESTART=.FALSE." />

    <!-- cell size -->
    <var delta="0.10" />

    <!-- gemetrical parameter -->    
    <var low_ceiling_height="3.00" />
    <var low_platform_length="60.00" />
    <var low_platform_width="3.00" />    
    <var low_rail_width="1.50" />            
    <var low_platform_height="1.00" />
    
    <var low_stairs_width="2.00" />
    <var low_stairs_length="20.0" />
    <var low_stairs_height="3.0" />
    <var low_stairs_elevation="10.0" />
    
    <var low_wall_thickness="2*delta" />
    
    <var high_width="10.0" />
    <var high_length="7.0" />
    <var high_height="3.0" />
    
    <var high_stairs_length="7.0" />
    <var high_stairs_elevation="5.0" />
    <var high_stairs_height="3.0" />
    <var high_stairs_width="2.0" />
    
    <section id="lower platform domain">
    
        <var low_min_x="0.0" />
        <var low_max_x="low_platform_length" />
        <var low_min_y="0.0" />
        <var low_max_y="low_platform_width + 2*low_rail_width" />
        <var low_min_z="-low_platform_height" />
        <var low_max_z="low_ceiling_height" />
    
        <my_room x1="low_min_x" x2="low_max_x"
                 y1="low_min_y" y2="low_max_y"
                 z1="low_min_z" z2="low_max_z"
                 wt="low_wall_thickness"
                 by1="1" by2="1" bz1="1" bz2="1" />
    
        <var low_dom_min_x="xmin" />
        <var low_dom_max_x="xmax" />
        <var low_dom_min_y="ymin" />
        <var low_dom_max_y="ymax" />
        <var low_dom_min_z="zmin" />
        <var low_dom_max_z="zmax" />

        <mesh />

        <boundary x="open" y="open" zmax="open"/>

        <section id="x+z walls">
            <obst xb="low_dom_min_x, low_dom_max_x, low_dom_min_y, low_min_y, low_dom_min_z, low_dom_max_z" 
                  color="'INVISIBLE'" />
            <obst xb="low_dom_min_x, low_dom_max_x, low_max_y, low_dom_max_y, low_dom_min_z, low_dom_max_z" />
            <obst xb="low_dom_min_x, low_dom_max_x, low_dom_min_y, low_dom_max_y, low_dom_min_z, low_min_z - low_platform_height" />            
            <obst xb="low_dom_min_x, low_dom_max_x, low_dom_min_y, low_dom_max_y, low_max_z, low_dom_max_z" />                        
        </section>
    
        <section id="platform">
            <obst xb="low_dom_min_x, low_dom_max_x, low_rail_width, low_rail_width + low_platform_width, low_dom_min_z, low_min_z + low_platform_height" />
        </section>

        <section id="tunnel">
            <var tunnel_length="10.0" />
            
            <!-- xmin + ymin tunnel -->
            <var x1 = "-tunnel_length" />
            <var x2 = "low_dom_min_x" /> 
            <var y1 = "low_min_y" />
            <var y2 = "low_rail_width" />
            <var z1 = "low_min_z" />
            <var z2 = "low_max_z" />
            
            <my_room wt="low_wall_thickness" by1="1" by2="1" bz1="1" bz2="1" ax="0"/>
            <mesh />
            
            <obst xb="xmin, xmax, ymin, y1, zmin, zmax" color="'INVISIBLE'"/>
            <obst xb="xmin, xmax, y2, ymax, zmin, zmax" color="'INVISIBLE'"/>            
            <obst xb="xmin, xmax, ymin, ymax, zmin, z1" />
            <obst xb="xmin, xmax, ymin, ymax, z2, zmax" />            

            <!-- xmin + ymax tunnel -->
            <var x1 = "-tunnel_length" />
            <var x2 = "low_dom_min_x" /> 
            <var y1 = "low_rail_width + low_platform_width" />
            <var y2 = "low_max_y" />
            <var z1 = "low_min_z" />
            <var z2 = "low_max_z" />
            
            <my_room wt="low_wall_thickness" by1="1" by2="1" bz1="1" bz2="1" ax="0"/>
            <mesh />

            <obst xb="xmin, xmax, ymin, y1, zmin, zmax" color="'INVISIBLE'"/>
            <obst xb="xmin, xmax, y2, ymax, zmin, zmax" color="'INVISIBLE'"/>            
            <obst xb="xmin, xmax, ymin, ymax, zmin, z1" />
            <obst xb="xmin, xmax, ymin, ymax, z2, zmax" />            
 
            <!-- xmax + ymin tunnel -->
            <var x1 = "low_dom_max_x" />
            <var x2 = "low_dom_max_x+tunnel_length" /> 
            <var y1 = "low_min_y" />
            <var y2 = "low_rail_width" />
            <var z1 = "low_min_z" />
            <var z2 = "low_max_z" />
            
            <my_room wt="low_wall_thickness" by1="1" by2="1" bz1="1" bz2="1"/>
            <mesh />

            <obst xb="xmin, xmax, ymin, y1, zmin, zmax" color="'INVISIBLE'"/>
            <obst xb="xmin, xmax, y2, ymax, zmin, zmax" color="'INVISIBLE'"/>            
            <obst xb="xmin, xmax, ymin, ymax, zmin, z1" />
            <obst xb="xmin, xmax, ymin, ymax, z2, zmax" />            

            <!-- xmax + ymax tunnel -->
            <var x1 = "low_dom_max_x" />
            <var x2 = "low_dom_max_x+tunnel_length" /> 
            <var y1 = "low_rail_width + low_platform_width" />
            <var y2 = "low_max_y" />
            <var z1 = "low_min_z" />
            <var z2 = "low_max_z" />
            
            <my_room wt="low_wall_thickness" by1="1" by2="1" bz1="1" bz2="1" ax="0"/>
            <mesh />
            
            <obst xb="xmin, xmax, ymin, y1, zmin, zmax" color="'INVISIBLE'"/>
            <obst xb="xmin, xmax, y2, ymax, zmin, zmax" color="'INVISIBLE'"/>            
            <obst xb="xmin, xmax, ymin, ymax, zmin, z1" />
            <obst xb="xmin, xmax, ymin, ymax, z2, zmax" />            

    
        </section>
    
    </section>

    <section id="stairs lower to upper level">
    
        <!-- xmin stairs -->
        <var x2="low_dom_min_x" />
        <var x1="x2-low_stairs_length" />
        <var y1="low_min_y + low_rail_width + (low_platform_width - low_stairs_width)*0.5" />
        <var y2="y1 + low_stairs_width" />        
        <var z1="low_min_z + low_platform_height" />
        <var z2="z1 + low_stairs_elevation + low_stairs_height" />
        
        <my_room wt="low_wall_thickness" by1="1" by2="1" bz1="1" bz2="1" ax="0" />
        <mesh />
        
        <obst xb="xmin, xmax, ymin, y1, zmin, zmax" color="'INVISIBLE'"/>
        <obst xb="xmin, xmax, y2, ymax, zmin, zmax" color="'INVISIBLE'"/>            
        <obst xb="xmin, xmax, ymin, ymax, zmin, z1" />
        <obst xb="xmin, xmax, ymin, ymax, z2, zmax" />
    
        <var slope = "low_stairs_elevation / low_stairs_length" />
        <loop var="ix" start="0" stop="nx">
            <var x = "low_min_x - ix*delta" />
            <var z = "low_min_z + low_platform_height + ix*delta*slope" />           
            <obst xb="x, x+delta, y1, y2, z1, z" />
            <obst xb="x, x+delta, y1, y2, z+low_stairs_height, z2" />        
        </loop>
        
        
        <!-- xmax stairs -->
        <var x1="low_max_x" />
        <var x2="x1+low_stairs_length" />
        <var y1="low_min_y + low_rail_width + (low_platform_width - low_stairs_width)*0.5" />
        <var y2="y1 + low_stairs_width" />        
        <var z1="low_min_z + low_platform_height" />
        <var z2="z1 + low_stairs_elevation + low_stairs_height" />
        
        <my_room wt="low_wall_thickness" by1="1" by2="1" bz1="1" bz2="1" ax="0" />
        <mesh />
        
        <obst xb="xmin, xmax, ymin, y1, zmin, zmax" color="'INVISIBLE'"/>
        <obst xb="xmin, xmax, y2, ymax, zmin, zmax" color="'INVISIBLE'"/>            
        <obst xb="xmin, xmax, ymin, ymax, zmin, z1" />
        <obst xb="xmin, xmax, ymin, ymax, z2, zmax" />
    
        <var slope = "low_stairs_elevation / low_stairs_length" />
        <loop var="ix" start="0" stop="nx">
            <var x = "low_max_x + ix*delta" />
            <var z = "low_min_z + low_platform_height + ix*delta*slope" />           
            <obst xb="x, x+delta, y1, y2, z1, z" />
            <obst xb="x, x+delta, y1, y2, z+low_stairs_height, z2" />        
        </loop>
    
    </section>
    
    <section id="upper level at xmin">
    
        <!-- xmin upper room -->
        <var x2="low_min_x - low_stairs_length" />
        <var x1="x2 - high_length" />
        <var y1="low_min_y + low_rail_width + 0.5*low_platform_width - 0.5*high_width" />
        <var y2="y1 + high_width" />
        <var z1="low_min_z + low_platform_height + low_stairs_elevation" />
        <var z2="z1 + high_height" />
        
        <my_room wt="low_wall_thickness" bx1="1" bx2="1" by1="1" by2="1" bz1="1" bz2="1" ax="0" />
        <mesh />
        
        <var high_min_x = "x1" />
        <var high_max_x = "x2" />
        <var high_min_y = "y1" />
        <var high_max_y = "y2" />
        <var high_min_z = "z1" />
        <var high_max_z = "z2" />                                        

        <var high_dom_min_x = "xmin" />
        <var high_dom_max_x = "xmax" />
        <var high_dom_min_y = "ymin" />
        <var high_dom_max_y = "ymax" />
        <var high_dom_min_z = "zmin" />
        <var high_dom_max_z = "zmax" />                                        

        
        <!-- xdirection stairs -->
        <var x2="high_min_x" />
        <var x1="x2-high_stairs_length" />
        <var y2="high_max_y" />
        <var y1="y2 - high_stairs_width" />        
        <var z1="high_min_z" />
        <var z2="z1 + high_stairs_elevation + high_stairs_height" />
        
        <my_room wt="low_wall_thickness" by1="1" by2="1" bz1="1" bz2="1" ax="0" />
        <mesh />
        
        <obst xb="xmin, xmax, ymin, y1, zmin, zmax" color="'INVISIBLE'"/>
        <obst xb="xmin, xmax, y2, ymax, zmin, zmax" color="'INVISIBLE'"/>            
        <obst xb="xmin, xmax, ymin, ymax, zmin, z1" />
        <obst xb="xmin, xmax, ymin, ymax, z2, zmax" />
    
        <var slope = "high_stairs_elevation / high_stairs_length" />
        <loop var="ix" start="0" stop="nx">
            <var x = "high_min_x - ix*delta" />
            <var z = "high_min_z + ix*delta*slope" />           
            <obst xb="x, x+delta, y1, y2, z1, z" />
            <obst xb="x, x+delta, y1, y2, z+high_stairs_height, z2" />        
        </loop>
        
        <!-- ydirection stairs -->
        <var x1="high_min_x" />
        <var x2="x1+high_stairs_width" />
        <var y2="high_min_y" />
        <var y1="y2 - high_stairs_length" />        
        <var z1="high_min_z" />
        <var z2="z1 + high_stairs_elevation + high_stairs_height" />
        
        <my_room wt="low_wall_thickness" bx1="1" bx2="1" bz1="1" bz2="1" ax="0" />
        <mesh />
        
        <obst xb="xmin, xmax, ymin, y1, zmin, zmax" color="'INVISIBLE'"/>
        <obst xb="xmin, xmax, y2, ymax, zmin, zmax" color="'INVISIBLE'"/>            
        <obst xb="xmin, xmax, ymin, ymax, zmin, z1" />
        <obst xb="xmin, xmax, ymin, ymax, z2, zmax" />
    
        <var slope = "high_stairs_elevation / high_stairs_length" />
        <loop var="iy" start="0" stop="ny">
            <var y = "high_min_y - iy*delta" />
            <var z = "high_min_z + iy*delta*slope" />           
            <obst xb="x1, x2, y, y+delta, z1, z" />
            <obst xb="x1, x2, y, y+delta, z+high_stairs_height, z2" />        
        </loop>
    
    </section>
    
        <section id="upper level at xmax">
    
        <!-- xmax upper room -->
        <var x1="low_max_x + low_stairs_length" />
        <var x2="x1 + high_length" />
        <var y1="low_min_y + low_rail_width + 0.5*low_platform_width - 0.5*high_width" />
        <var y2="y1 + high_width" />
        <var z1="low_min_z + low_platform_height + low_stairs_elevation" />
        <var z2="z1 + high_height" />
        
        <my_room wt="low_wall_thickness" bx1="1" bx2="1" by1="1" by2="1" bz1="1" bz2="1" ax="1" />
        <mesh />
        
        <var high_min_x = "x1" />
        <var high_max_x = "x2" />
        <var high_min_y = "y1" />
        <var high_max_y = "y2" />
        <var high_min_z = "z1" />
        <var high_max_z = "z2" />                                        

        <var high_dom_min_x = "xmin" />
        <var high_dom_max_x = "xmax" />
        <var high_dom_min_y = "ymin" />
        <var high_dom_max_y = "ymax" />
        <var high_dom_min_z = "zmin" />
        <var high_dom_max_z = "zmax" />                                        

        
        <!-- xdirection stairs -->
        <var x1="high_max_x" />
        <var x2="x1+high_stairs_length" />
        <var y2="high_max_y" />
        <var y1="y2 - high_stairs_width" />        
        <var z1="high_min_z" />
        <var z2="z1 + high_stairs_elevation + high_stairs_height" />
        
        <my_room wt="low_wall_thickness" by1="1" by2="1" bz1="1" bz2="1" ax="1" />
        <mesh />
        
        <obst xb="xmin, xmax, ymin, y1, zmin, zmax" color="'INVISIBLE'"/>
        <obst xb="xmin, xmax, y2, ymax, zmin, zmax" color="'INVISIBLE'"/>            
        <obst xb="xmin, xmax, ymin, ymax, zmin, z1" />
        <obst xb="xmin, xmax, ymin, ymax, z2, zmax" />
    
        <var slope = "high_stairs_elevation / high_stairs_length" />
        <loop var="ix" start="0" stop="nx">
            <var x = "high_max_x + ix*delta" />
            <var z = "high_min_z + ix*delta*slope" />           
            <obst xb="x, x+delta, y1, y2, z1, z" />
            <obst xb="x, x+delta, y1, y2, z+high_stairs_height, z2" />        
        </loop>
        
        <!-- ydirection stairs -->
        <var x1="high_min_x" />
        <var x2="x1+high_stairs_width" />
        <var y2="high_min_y" />
        <var y1="y2 - high_stairs_length" />        
        <var z1="high_min_z" />
        <var z2="z1 + high_stairs_elevation + high_stairs_height" />
        
        <my_room wt="low_wall_thickness" bx1="1" bx2="1" bz1="1" bz2="1" ax="0" />
        <mesh />
        
        <obst xb="xmin, xmax, ymin, y1, zmin, zmax" color="'INVISIBLE'"/>
        <obst xb="xmin, xmax, y2, ymax, zmin, zmax" color="'INVISIBLE'"/>            
        <obst xb="xmin, xmax, ymin, ymax, zmin, z1" />
        <obst xb="xmin, xmax, ymin, ymax, z2, zmax" />
    
        <var slope = "high_stairs_elevation / high_stairs_length" />
        <loop var="iy" start="0" stop="ny">
            <var y = "high_min_y - iy*delta" />
            <var z = "high_min_z + iy*delta*slope" />           
            <obst xb="x1, x2, y, y+delta, z1, z" />
            <obst xb="x1, x2, y, y+delta, z+high_stairs_height, z2" />        
        </loop>
    
    </section>

</fds>
