<fds>

    <para dim="ventilation" var="doorwidth" list="1.0, 0.8, 0.6" />

    <var doorheight="1.85" />
    <var fire_pos="1.5" />

    <!-- file naming -->
    <var chid="'room_2doors'" outfile="'room_2doors_id%03d.fds'%para_id" />
    <info chid="chid" outfile="outfile"/>

    <!-- fixed input parameter -->
    <input text="TIME T_END=5.0" />
    <input text="MISC RESTART=.FALSE." />
    <input text="PART ID='smoke', MASSLESS=.TRUE., SAMPLING_FACTOR=1" />

    <!-- domain and mesh definition -->
    <var delta = "0.05" />

    <var roomlx = "3.0" roomly="3.0" roomlz="2.25"/>
    <var bufflx = "1.5" buffly="1.5" bufflz="0.75"/>
    <var wallthick = "0.1" />

    <var dxmin = "0.0"  dxmax = "roomlx + bufflx"/>
    <var dymin = "0.0"  dymax = "roomly + buffly"/>
    <var dzmin = "0.0"  dzmax = "roomlz + bufflz"/>    

    <var nx = "int(div235((dxmax - dxmin) / delta))" />
    <var ny = "int(div235((dymax - dymin) / delta))" />
    <var nz = "int(div235((dzmax - dzmin) / delta))" />
    
    <var xmax = "dxmin + nx * delta" />
    <var ymax = "dymin + ny * delta" />
    <var zmax = "dzmin + nz * delta" />        
    <var xmin = "dxmin"  ymin = "dymin"  zmin = "dzmin" />

    <boundary x="open" y="open" zmax="open"/>

    <mesh />

    <!-- wall material and surface definition -->

    <matl 
        id            = "'LIGHTWEIGHT INSULATION'" 
        density	      = "340."
        conductivity  = "0.048"
        specific_heat = "1.13" />

    <surf
        id        = "'LIGHTWEIGHT INSULATION' "
        color     = "'GRAY'"
        backing   = "'EXPOSED'"
        matl_id   = "'LIGHTWEIGHT INSULATION'"
        thickness = "0.10" />

    <!-- xmin wall -->
    <obst xb="xmin, xmin + wallthick, ymin, roomly, zmin, roomlz"  surf_id="'LIGHTWEIGHT INSULATION'"/>
    <!-- xmax wall -->
    <obst xb="roomlx - wallthick, roomlx, ymin, roomly, zmin, roomlz" surf_id="'LIGHTWEIGHT INSULATION'"/>
    <!-- ymin wall -->
    <obst xb="xmin, roomlx, ymin, ymin + wallthick, zmin, roomlz" surf_id="'LIGHTWEIGHT INSULATION'"/>
    <!-- ymax wall -->
    <obst xb="xmin, roomlx, roomly - wallthick, roomly, zmin, roomlz" surf_id="'LIGHTWEIGHT INSULATION'"/>
    <!-- zmax wall -->
    <obst xb="xmin, roomlx, ymin, roomly, roomlz, roomlz + wallthick" surf_id="'LIGHTWEIGHT INSULATION'"/>
    <!-- zmin wall -->
    <obst xb="xmin, xmax, ymin, ymax, 0.0, wallthick" surf_id="'LIGHTWEIGHT INSULATION'"/>

    <!-- door 1 -->
    <var door_x  = "roomlx" />
    <var door_y1 = "roomly/2.0 - doorwidth/2.0" door_y2 = "roomly/2.0 + doorwidth/2.0" />
    <var door_z1 = "wallthick" door_z2="wallthick + doorheight" />
    <hole xb="door_x-wallthick, door_x, door_y1, door_y2, door_z1, door_z2" />
    <device id="'DOOR1 MASS_FLOW+'" x1="door_x" x2="door_x" 
                y1="door_y1" y2="door_y2" z1="door_z1" z2="door_z2" q="'MASS FLOW +'" />
    <device id="'DOOR1 MASS_FLOW-'" x1="door_x" x2="door_x" 
                y1="door_y1" y2="door_y2" z1="door_z1" z2="door_z2" q="'MASS FLOW -'" />

    <!-- door 2 -->
    <var door_y  = "roomly" />
    <var door_x1 = "roomlx/2.0 - doorwidth/2.0" door_x2 = "roomlx/2.0 + doorwidth/2.0" />
    <var door_z1 = "wallthick" door_z2="wallthick + doorheight" />
    <hole xb="door_x1, door_x2, door_y-wallthick, door_y, door_z1, door_z2" />
    <device id="'DOOR2 MASS_FLOW+'" x1="door_x1" x2="door_x2" 
                y1="door_y" y2="door_y" z1="door_z1" z2="door_z2" q="'MASS FLOW +'" />
    <device id="'DOOR2 MASS_FLOW-'" x1="door_x1" x2="door_x2" 
                y1="door_y" y2="door_y" z1="door_z1" z2="door_z2" q="'MASS FLOW -'" />


    <!-- fire -->
    <reac 
        id="'METHANE'"
        C = "1."
        H = "4." />
          
    <surf id="'FIRE'" hrrpua="698" color="'RED'" />
          
    <var fire_radius = "0.15" />
    <obst 
        xb="fire_pos-fire_radius, fire_pos+fire_radius, fire_pos-fire_radius, fire_pos+fire_radius, wallthick, wallthick"
        color="'RED'"
        surf_id="'FIRE'" />
    <vent 
        xb="fire_pos-fire_radius, fire_pos+fire_radius, fire_pos-fire_radius, fire_pos+fire_radius, wallthick, wallthick"
        surf_id="'FIRE'" />
    
          
    <!-- slices -->
    <slice x="roomlx/2.0" q="TEMPERATURE"/>
    <slice y="roomly/2.0" q="TEMPERATURE"/>    
    <slice x="roomlx/2.0" q="VELOCITY" v="1"/>
    <slice y="roomly/2.0" q="VELOCITY" v="1"/>    
    <slice y="4.20" q="TEMPERATURE"/>
    
    <!-- devices in doors -->
    <loop var="iz" start="0" stop="doorheight / delta">
        <var z="wallthick + iz * delta" />
        <device id="'DOOR1 TC %d'%iz" x="roomlx" y="roomly/2.0" z="z" q="'THERMOCOUPLE'" />
        <device id="'DOOR1 VE %d'%iz" x="roomlx" y="roomly/2.0" z="z" q="'VELOCITY'" />        
        <device id="'DOOR2 TC %d'%iz" x="roomlx/2.0" y="roomly" z="z" q="'THERMOCOUPLE'" />
        <device id="'DOOR2 VE %d'%iz" x="roomlx/2.0" y="roomly" z="z" q="'VELOCITY'" />        
    </loop>
    
    <!-- devices in corner -->
    <loop var="iz" start="0" stop="roomlz / delta">
        <var z="wallthick + iz * delta" />
        <device id="'CORNER TC %d'%iz" x="0.5" y="roomly - 0.5" z="z" q="'THERMOCOUPLE'" />
        <device id="'CORNER VE %d'%iz" x="0.5" y="roomly - 0.5" z="z" q="'VELOCITY'" />        
    </loop>
    
    <!-- devices at fire -->
    <var ndev="20.0" len="0.75"/>
    <loop var="iz" start="0" stop="ndev">
        <loop var="ixy" start="0" stop="ndev">
            <var z="wallthick + iz/ndev * len" />
            <var xy="fire_pos-0.25 + ixy/ndev * len" />
            <device id="'FIRE-TC-GRID %d.%d'%(iz,ixy)" x="xy" y="xy" z="z" q="'THERMOCOUPLE'" /> 
        </loop>    
    </loop>            
    
</fds>
